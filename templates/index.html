{% extends "base.html" %}

{% block title %}Centro de Ayuda Tecopos{% endblock %}

{% block content %}

{% block hero %}
<!-- HERO HEADER NEGRO -->
<header class="hero-header">
  <h1>Centro de Ayuda Tecopos</h1>
  <p>Documentación clara y organizada, al estilo de Slack.</p>

  <div class="search-wrapper">
    <form action="/" method="get">
      <input
        type="text"
        name="q"
        placeholder="Buscar errores, ayuda o preguntas frecuentes..."
        value="{{ q }}"
      />
    </form>
  </div>
</header>
{% endblock %}



<!-- CONTENIDO PRINCIPAL -->
<div class="container">

  <!-- CATEGORÍAS -->
  <section id="categorias">
    <h2>Categorías principales</h2>

    <p style="margin: 4px 0 12px; font-size:0.9rem;">
      Ver todas las categorías →
      <a href="/categories">Ir a categorías</a>
    </p>

    <div class="categories">
      {% if categories %}
        {% for cat in categories %}
          <a href="/?category={{ cat }}" class="cat-link">
            <div class="cat-box{% if selected_category == cat %} cat-box-active{% endif %}">
              <h3>{{ cat|replace('-', ' ')|title }}</h3>
              <p>Ver incidencias y documentación relacionada.</p>
            </div>
          </a>
        {% endfor %}
      {% else %}
        <p>No hay categorías registradas todavía.</p>
      {% endif %}
    </div>
  </section>

  <!-- ARTÍCULOS DESTACADOS (ERRORES FRECUENTES) -->
  <section id="articulos" class="article-list">
    <h2>Errores destacados</h2>

    {% if errors %}
      {% for e in errors %}
        <div class="article-item">
          <h4>
            <a href="/errors/{{ e.id }}">{{ e.title }}</a>
          </h4>
          <p>
            {% if e.short_description %}
              {{ e.short_description }}
            {% elif e.description %}
              {{ e.description | truncate(120, True, '…') }}
            {% elif e.answer %}
              {{ e.answer | truncate(120, True, '…') }}
            {% else %}
              Sin descripción disponible.
            {% endif %}
          </p>
          <a href="/errors/{{ e.id }}">Ver solución completa →</a>
        </div>
      {% endfor %}
    {% else %}
      <p>
        Todavía no tienes errores destacados. Puedes crearlos desde la
        sección de <a href="/admin">Gestión</a>.
      </p>
    {% endif %}
  </section>

  <!-- CHAT PREVIEW -->
  <section id="chat">
    <h2>Vista previa del chatbot</h2>
    <div class="chatbox">
      <div class="msg">
        <strong>Bot:</strong> Hola, ¿qué error estás viendo?
      </div>
      <div class="msg">
        <strong>Usuario:</strong> Me aparece que no tengo permisos.
      </div>
      <div class="msg">
        <strong>Bot:</strong>
        Normalmente esto ocurre cuando tu rol no tiene acceso a ese módulo.
        Solicita a tu administrador revisar tu perfil.
      </div>
    </div>
  </section>

</div>

<footer>
  Tecopos © Centro de Ayuda — estilo Slack, negro, blanco y naranja
</footer>

{% endblock %}
