{% extends "base.html" %}

{% block title %}{{ error.title }} – Centro de Ayuda Tecopos{% endblock %}

{% block hero %}
<header class="hero-header">
    <div class="detail-header">
        <div>
            <div class="block-label">
                {% if error.type == "error" %}
                    Error
                {% elif error.type == "guia" %}
                    Guía
                {% elif error.type == "comportamiento" %}
                    Comportamiento
                {% elif error.type == "faq" %}
                    FAQ
                {% elif error.type == "novedad" %}
                    Novedad
                {% else %}
                    Documento
                {% endif %}
            </div>
            {# Use h2 for the detail title to reduce visual weight.  A
               custom class provides extra styling if needed #}
            <h2 class="detail-title">{{ error.title }}</h2>
            <p class="detail-subtitle">
                {% if error.short_description %}
                    {{ error.short_description }}
                {% elif error.description %}
                    {{ error.description | truncate(120, True, '…') }}
                {% elif error.answer %}
                    {{ error.answer | truncate(120, True, '…') }}
                {% endif %}
            </p>
        </div>
        <div class="detail-tags">
            <span class="tag tag-category">{{ error.category }}</span>
            {% if error.is_common %}
                <span class="tag tag-common">Frecuente</span>
            {% endif %}
        </div>
    </div>
</header>
{% endblock %}

{% block content %}
<section class="section">

    <div class="detail-grid">
        <div class="detail-main">
            {# Contenido dinámico en función del tipo de artículo #}
            {% if error.type == "error" %}
                <section class="detail-block">
                    <h2>Mensaje para el cliente</h2>
                    <p>{{ error.client_message }}</p>
                </section>
                {% if error.causes %}
                <section class="detail-block">
                    <h2>Posibles causas</h2>
                    <ul>
                        {% for c in error.causes %}
                            <li>{{ c }}</li>
                        {% endfor %}
                    </ul>
                </section>
                {% endif %}
                {% if error.quick_steps %}
                <section class="detail-block">
                    <h2>Pasos rápidos para el usuario</h2>
                    <ol>
                        {% for s in error.quick_steps %}
                            <li>{{ s }}</li>
                        {% endfor %}
                    </ol>
                </section>
                {% endif %}
                {% if error.internal_steps %}
                <section class="detail-block">
                    <h2>Pasos internos (soporte)</h2>
                    <ol>
                        {% for s in error.internal_steps %}
                            <li>{{ s }}</li>
                        {% endfor %}
                    </ol>
                </section>
                {% endif %}
            {% elif error.type == "guia" %}
                {% if error.description %}
                <section class="detail-block">
                    <h2>Descripción</h2>
                    <p>{{ error.description }}</p>
                </section>
                {% endif %}
                {% if error.steps %}
                <section class="detail-block">
                    <h2>Paso a paso</h2>
                    <ol>
                        {% for s in error.steps %}
                            <li>{{ s }}</li>
                        {% endfor %}
                    </ol>
                </section>
                {% endif %}
            {% elif error.type == "comportamiento" or error.type == "novedad" %}
                {% if error.description %}
                <section class="detail-block">
                    <h2>Descripción</h2>
                    <p>{{ error.description }}</p>
                </section>
                {% endif %}
            {% elif error.type == "faq" %}
                <section class="detail-block">
                    <h2>Respuesta</h2>
                    <p>{{ error.answer }}</p>
                </section>
                {% if error.tags %}
                <section class="detail-block">
                    <h2>Etiquetas</h2>
                    <ul>
                        {% for t in error.tags %}
                            <li>{{ t }}</li>
                        {% endfor %}
                    </ul>
                </section>
                {% endif %}
            {% else %}
                {# Caso genérico: mostramos descripción si existe #}
                {% if error.description %}
                <section class="detail-block">
                    <h2>Descripción</h2>
                    <p>{{ error.description }}</p>
                </section>
                {% endif %}
            {% endif %}
        </div>

        <aside class="detail-side">
            {% if error.images %}
            <section class="detail-block">
                <h3>Capturas</h3>
                <div class="images-grid">
                    {% for img in error.images %}
                        <a href="{{ img }}" target="_blank">
                            <img src="{{ img }}" alt="Captura relacionada" />
                        </a>
                    {% endfor %}
                </div>
            </section>
            {% endif %}

            {% if error.video_url %}
            <section class="detail-block">
                <h3>Video explicativo</h3>
                <video controls class="detail-video">
                    <source src="{{ error.video_url }}" />
                    Tu navegador no soporta video HTML5.
                </video>
            </section>
            {% endif %}
        </aside>
    </div>
</section>
{% endblock %}
